<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://api.mapbox.com/mapbox-gl-js/v1.7.0/mapbox-gl.js"></script>
        <link href="https://api.mapbox.com/mapbox-gl-js/v1.7.0/mapbox-gl.css" rel="stylesheet" />
        <link rel="stylesheet" href="style.css"/>
    </head>
    <body>
        <div id="map"></div>
        <div class="map-overlay">
        <div id="information">
            <div class="select-menu">
                <div id="welcome-information">Welcome to the WHO World No Tobacco Day site! Here is where we can add more text about the tool! </div>
                <nav id="menu"></nav>
            </div>

            <div class="variable-title">
                
                <p>Click on the map to get country-specific indicator information</p>
                <h4 id="title">Youths 13-15 ever offered a free cigarette by a tobacco company representative</h4>
                <div id="percentagesList">
                <p><b>Total: </b></p>
                <p><b>Percentage of girls: </b></p>
                <p><b>Percentage of boys: </b></p>
                </div>
            </div>
            <div id='legend'>
                <div><span class='legend-key' style='background-color:#fff28b'></span><span class='legend-value'>Less than 3.0%</span></div>
                <div><span class='legend-key' style='background-color:#daa613'></span><span class='legend-value'>3.1 - 6.0%</span></div>
                <div><span class='legend-key' style='background-color:#d45313'></span><span class='legend-value'>6.1 - 9.0%</span></div>
                <div><span class='legend-key' style='background-color:#9D1319'></span><span class='legend-value'>9.1 - 13.0%</span></div>
                <div><span class='legend-key' style='background-color:#780c22'></span><span class='legend-value'>Greater than 13.0%</span></div>
                <div><span class='legend-key' style='background-color:#ffffff'></span><span class='legend-value'>Data not available</span></div>
              
            </div>
        </div>
        <script>

            mapboxgl.accessToken = 'pk.eyJ1IjoibWFwYm94LWNvbW11bml0eSIsImEiOiJjazhrbnF1NWIwMHVjM2Zwbmh2OWs2dTI1In0.O8lasZoOGKUihm-HVEZxaQ';
            var map = new mapboxgl.Map({
                container: 'map', //map container
                style: 'mapbox://styles/mapbox-community/ck9u9c0i01ah41io879ylfl4d', // Mapbox style
                center: [34.7, 15.5] , // starting position [lng, lat]
                zoom: 1, // starting zoom
            });


            var toggleableLayerIds = ['indicator-4b', 'indicator-3b', 'indicator-2b'];

            toggleableLayerIds.forEach(function(id) {
              var link = document.createElement('a');
              link.href = '#';
              link.className = 'active';
              link.textContent = id;

              link.onclick = toggleLayers;

              var menu = document.getElementById('menu');
              menu.appendChild(link);
            });

            function toggleLayers(e) {
              var clickedLayer = this.textContent;
              e.preventDefault();
              e.stopPropagation();

              toggleableLayerIds.forEach(function(layer) {
                if (layer == clickedLayer) {
                  map.setLayoutProperty(layer, 'visibility', 'visible');
                } else {
                  map.setLayoutProperty(layer, 'visibility', 'none');
                }
              });

              var layerKey = {
                'indicator-2b': {
                  values: ['Less than 3.0%', '3.1 - 6.0%', '6.1 - 9.0%', '9.1 - 13.0%', 'Greater than 13.0%', 'Data not available'],
                  colors: ['#FFF28B', '#DAA613', '#D45313', '#9D1319', '#780C22', '#ffffff'],
                  title: ["Youths 13-15 ever offered a free cigarette by a tobacco company representative"]
                },

                'indicator-3b': {
                  values: ['Less than 45.0%', '45.1 - 63.0%', '63.1 - 76.0%', '76.1 - 86.0%', 'Greater than 86.0%', 'Data not available'],
                  colors: ['#FFF28B', '#DAA613', '#D45313', '#9D1319', '#780C22', '#ffffff'],
                  title: ["Youths 13-15 favored banning smoking in enclosed public places"]
                },

                'indicator-4b': {
                  values: ['Less than 8.0%', '8.1 - 12.0%', '12.1 - 15.0%', '15.1 - 20.0%', 'Greater than 20.0%', 'Data not available'],
                  colors: ['#FFF28B', '#DAA613', '#D45313', '#9D1319', '#780C22', '#ffffff'],
                  title: ["Youths 13-15 had object with a cigarette or tobacco logo on it"]
                }
              }


              toggleableLayerIds.forEach(function(){
                  
                var values = layerKey[clickedLayer].values;
                var colors = layerKey[clickedLayer].colors;
                var title = layerKey[clickedLayer].title;

                var items = '';
                var legend = document.getElementById('legend');
                var variableTitle = document.getElementById('title');

                variableTitle.innerHTML = title; 
            
                for (i = 0; i < values.length; i++){
                  var indicator = values[i];
                  var color = colors[i];
                  
                  var key = `<span class='legend-key' style='background-color:${color}'></span>`;
                  var value = `<span class='legend-value'>${indicator}</span>`;
                  var item = `<div>${key}${value}</div>`;
                  items += item;
                }
                legend.innerHTML = items;
                

            });
          }


        </script>
    </body>
</html>
